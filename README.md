# Yunzai-DeepSeek-JS
适用于 **Yunzai-Bot** 的 DeepSeek AI聊天插件。

## 使用方式
1. 将插件的 `js` 文件下载到本地。
2. 打开插件的 `js` 文件，在 **第五行** 填写你的 API KEY（通过 https://platform.deepseek.com/ 获取）。
3. 在云崽的根目录运行命令：
```
pnpm install openai -w
```

## 插件功能
- 提供DeepSeek v3 AI聊天功能
- 对话支持获取聊天记录与上下文，为AI提供at群友能力（自定义提示词需提供引导）
- 支持配置聊天记录和上下文的获取长度、提示词、温度

## 插件命令

- `#chat` 与AI聊天
- `#deepseek结束对话` 结束对话
- `#deepseek设置上下文长度3` 设置上下文获取长度（0-10），默认3
- `#deepseek设置群聊记录长度3` 设置群聊记录获取长度（0-20），默认3
- `#deepseek设置群聊提示词xxx` 设置提示词，提示词为空时使用默认提示词
- `#deepseek设置群聊温度1` 设置温度（0-2），默认1

## 成本参考

DeepSeek API 提供了10元新用户体验金，当前API价格为 

输入：**1元/百万tokens**(缓存未命中）**0.1元/百万tokens**(缓存命中）

输出：**2元/百万tokens**

DeepSeek v3 在大多数基准测试中优于GPT-4o、Qwen2.5、Claude-3.5-Sonnet，个人认为体验完胜GPT-4o，其API定价极低（目前平均1元/百万tokens，是GPT-4o的1/20），即使获取群聊上下文/增加对话轮数成本也很低（每次对话在¥0.0001 ~ ¥0.01）之间，以下提供了各类配置下的token消耗，测试的提问问题为"XX是什么"

| **对话轮数上限** | **群聊记录长度** | **Token 消耗**   | **成本范围**         |
|----------------|------------------|------------------|----------------------|
| 10             | 20               | 1000 - 8000      | ¥0.001 - ¥0.008      |
| 10             | 5                | 400 - 5000       | ¥0.0004 - ¥0.005     |
| 3              | 3                | 100 - 1200       | ¥0.0001 - ¥0.0012    |
| 0              | 0                | 30 - 400         | ¥0.00003 - ¥0.0004    |


目前AI对话内容会被记录在群聊记录中，会浪费至多一半token，后续将优化。目前也可通过#deepseek设置群聊记录长度0 禁用群聊记录获取

## To be continued
暂未适配私聊AI聊天，如需私聊使用请设置#deepseek设置群聊记录长度0

目前将群聊上下文从system转移到了user，可提高15%-20%缓存命中率，但可能影响回复效果，后续可自行设置提示词位置
